\documentclass[12pt]{article}
\usepackage{amsmath, amssymb}
\usepackage[margin=1in]{geometry}
\usepackage{enumitem}
\usepackage{mathtools}
\usepackage{fancybox}

\setlength{\parindent}{0pt}
\newcommand{\ans}[1]{\begin{center}\doublebox{\(\displaystyle #1\)}\end{center}}

\begin{document}

\begin{center}
\Large
\textbf{MMAE 450 -- Midterm 1 (Makeup) \;|\; Solution Key} \\[6pt]
\normalsize
\end{center}

\vspace{0.25in}

%----------------------------------------------------------
\section*{Problem 1: Newton Method for a Nonlinear System}

\[
f_1(u_1,u_2)=u_1^2+2u_1-u_2-3,\qquad
f_2(u_1,u_2)=u_1+u_2^2-2.
\]

\textbf{(a)} Jacobian:
\[
\mathbf{J}(u_1,u_2)=
\begin{bmatrix}
\frac{\partial f_1}{\partial u_1} & \frac{\partial f_1}{\partial u_2}\\[4pt]
\frac{\partial f_2}{\partial u_1} & \frac{\partial f_2}{\partial u_2}
\end{bmatrix}
=
\begin{bmatrix}
2u_1+2 & -1\\
1 & 2u_2
\end{bmatrix}.
\]

\textbf{(b)} One Newton step from $\mathbf{u}^{(0)}=\begin{bmatrix}1\\1\end{bmatrix}$.

Evaluate:
\[
\mathbf{f}(\mathbf{u}^{(0)})=
\begin{bmatrix}
1^2+2(1)-1-3\\
1+1^2-2
\end{bmatrix}
=
\begin{bmatrix}
-1\\
0
\end{bmatrix},
\qquad
\mathbf{J}(\mathbf{u}^{(0)})=
\begin{bmatrix}
4 & -1\\
1 & 2
\end{bmatrix}.
\]

Solve $\mathbf{J}(\mathbf{u}^{(0)})\,\Delta \mathbf{u}^{(0)}=\mathbf{f}(\mathbf{u}^{(0)})$:
\[
\begin{bmatrix}
4 & -1\\
1 & 2
\end{bmatrix}
\begin{bmatrix}
\Delta u_1\\
\Delta u_2
\end{bmatrix}
=
\begin{bmatrix}
-1\\
0
\end{bmatrix}
\;\;\Rightarrow\;\;
\Delta u_2=\frac{1}{9},\quad \Delta u_1=-\frac{2}{9}.
\]

Newton update $\mathbf{u}^{(1)}=\mathbf{u}^{(0)}-\Delta\mathbf{u}^{(0)}$:
\[
\mathbf{u}^{(1)}=
\begin{bmatrix}
1\\1
\end{bmatrix}
-
\begin{bmatrix}
-\frac{2}{9}\\[2pt]\frac{1}{9}
\end{bmatrix}
=
\begin{bmatrix}
\frac{11}{9}\\[2pt]\frac{8}{9}
\end{bmatrix}.
\]
\ans{\mathbf{u}^{(1)}=\left[\dfrac{11}{9},\;\dfrac{8}{9}\right]^T}

\textbf{(c)} Residual at $\mathbf{u}^{(1)}$:
\[
f_1\!\left(\tfrac{11}{9},\tfrac{8}{9}\right)=\frac{4}{81},\qquad
f_2\!\left(\tfrac{11}{9},\tfrac{8}{9}\right)=\frac{1}{81}.
\]
Thus the Euclidean norm is
\[
\|\mathbf{f}(\mathbf{u}^{(1)})\|
=
\sqrt{\left(\frac{4}{81}\right)^2+\left(\frac{1}{81}\right)^2}
=
\frac{\sqrt{17}}{81}
\approx 5.09\times 10^{-2}.
\]
\ans{\|\mathbf{f}(\mathbf{u}^{(1)})\|=\dfrac{\sqrt{17}}{81}\approx 0.0509}

\newpage
%----------------------------------------------------------
\section*{Problem 2: 1D Steady Conduction with Source}

PDE:
\[
\frac{d^2T}{dx^2}+5=0,\qquad 0\le x\le 1,\qquad T(0)=0,\;T(1)=100.
\]
With $\Delta x=0.25$, nodes $x_0=0$, $x_1=0.25$, $x_2=0.5$, $x_3=0.75$, $x_4=1$.
Unknowns: $T_1,T_2,T_3$ with $T_0=0$, $T_4=100$.

Use central difference:
\[
\frac{T_{i-1}-2T_i+T_{i+1}}{\Delta x^2}+5=0
\quad\Rightarrow\quad
T_{i-1}-2T_i+T_{i+1}=-5\Delta x^2.
\]
Here $\Delta x^2=0.0625$ so $-5\Delta x^2=-0.3125$.

\textbf{(a)} Interior equations:
\[
\begin{aligned}
i=1:\;& T_0-2T_1+T_2=-0.3125
&&\Rightarrow\; -2T_1+T_2=-0.3125,\\
i=2:\;& T_1-2T_2+T_3=-0.3125,\\
i=3:\;& T_2-2T_3+T_4=-0.3125
&&\Rightarrow\; T_2-2T_3=-100.3125.
\end{aligned}
\]

\textbf{(b)} Matrix system $\mathbf{A}\mathbf{T}=\mathbf{b}$ with
$\mathbf{T}=\begin{bmatrix}T_1&T_2&T_3\end{bmatrix}^T$:
\[
\underbrace{\begin{bmatrix}
-2 & 1 & 0\\
1 & -2 & 1\\
0 & 1 & -2
\end{bmatrix}}_{\mathbf{A}}
\underbrace{\begin{bmatrix}
T_1\\T_2\\T_3
\end{bmatrix}}_{\mathbf{T}}
=
\underbrace{\begin{bmatrix}
-0.3125\\
-0.3125\\
-100.3125
\end{bmatrix}}_{\mathbf{b}}.
\]
(Equivalent forms obtained by multiplying both sides by $-1$ are also correct.)

\newpage
%----------------------------------------------------------
\section*{Problem 3: FTCS Method}

\[
\frac{\partial T}{\partial t}=\alpha \frac{\partial^2T}{\partial x^2}.
\]

\textbf{(a)} Use forward difference in time and central difference in space:
\[
\frac{T_i^{n+1}-T_i^{n}}{\Delta t}
=
\alpha \frac{T_{i+1}^{n}-2T_i^{n}+T_{i-1}^{n}}{\Delta x^2}.
\]
Solve for $T_i^{n+1}$:
\[
T_i^{n+1}=T_i^{n}+\underbrace{\frac{\alpha\Delta t}{\Delta x^2}}_{r}\left(T_{i+1}^{n}-2T_i^{n}+T_{i-1}^{n}\right).
\]
\ans{T_i^{n+1}=T_i^{n}+r\left(T_{i+1}^{n}-2T_i^{n}+T_{i-1}^{n}\right)}

\textbf{(b)} Stability (1D FTCS diffusion):
\[
0\le r \le \frac{1}{2}.
\]
\ans{r\le \tfrac{1}{2}}

\textbf{(c)} Compute
\[
r=\frac{\alpha\Delta t}{\Delta x^2}
=\frac{(1.5)(0.02)}{(0.25)^2}
=\frac{0.03}{0.0625}
=0.48.
\]
Since $0.48<0.5$, the scheme is stable.
\ans{\text{Stable (}r=0.48<0.5\text{)}}

\newpage
%----------------------------------------------------------
\section*{Problem 4: Convection Boundary Condition}

Given at $x=0$:
\[
-k\frac{dT}{dx}(0)=h(T_0-T_\infty),
\qquad
\frac{dT}{dx}(0)\approx \frac{T_1-T_0}{\Delta x}.
\]
Substitute:
\[
-k\frac{T_1-T_0}{\Delta x}=h(T_0-T_\infty).
\]
A convenient discrete boundary equation is therefore
\[
\left(\frac{k}{\Delta x}-h\right)T_0-\frac{k}{\Delta x}T_1=-hT_\infty.
\]
Equivalently, solving for $T_0$ in terms of $T_1$:
\[
T_0=\frac{kT_1-h\Delta x\,T_\infty}{k-h\Delta x}.
\]
\ans{\left(\frac{k}{\Delta x}-h\right)T_0-\frac{k}{\Delta x}T_1=-hT_\infty}

\newpage
%----------------------------------------------------------
\section*{Problem 5: Conceptual Understanding}

\textbf{(a) Multiple Choice:}
\[
\begin{aligned}
1:&\;\text{B}\qquad
2:&\;\text{B}\qquad
3:&\;\text{B}\qquad
4:&\;\text{C}
\end{aligned}
\]
\ans{(1)\,B\;\;(2)\,B\;\;(3)\,B\;\;(4)\,C}

\textbf{(b) FTCS pseudocode (one time step):}
\begin{verbatim}
Given T[i] at time level n
Compute r = alpha*dt/dx^2

for i = 1 to N-1:          # interior nodes
    T_new[i] = T[i] + r*(T[i+1] - 2*T[i] + T[i-1])

apply boundary conditions to T_new[0], T_new[N]

T = T_new                  # advance to next time level
\end{verbatim}

\end{document}
