%=======================================================================
% mmae450/tex/lectures/lecture_fvm_1D_intro.tex
% Standalone Beamer deck that inputs an existing Chapter 5 .tikz figure
% located in: mmae450/tex/figures/lectures/
%
% IMPORTANT:
% The .tikz file itself does: \input{tex/preamble/tikz_house_styles.tex}
% so we add the repo root to TeX's input search path using \input@path.
%=======================================================================

\documentclass[aspectratio=169]{beamer}

% --- Your beamer styling (adjust path/name if yours differs)
\input{../preamble/beamer_styles.tex}

% --- TikZ (beamer_styles.tex may already load it; harmless if duplicated)
\usepackage{tikz}
\usetikzlibrary{arrows.meta,calc,positioning,decorations.pathreplacing}

% --- Make sure TeX can resolve paths like tex/preamble/... used INSIDE the .tikz
% From mmae450/tex/lectures, the repo root is ../../
\makeatletter
\def\input@path{{../../}{../}{./}}
\makeatother

\title{Finite Volume Method in 1D}
\subtitle{Control Volume Discretization (Chapter 5 figure)}
\author{MMAE 450}
\date{}

\begin{document}

% ----------------------------------------------------------------------
\begin{frame}
  \titlepage
\end{frame}




% ----------------------------------------------------------------------
% ----------------------------------------------------------------------
% ----------------------------------------------------------------------
% ----------------------------------------------------------------------
\begin{frame}{Internal Energy Equation (with Source)}

After substituting the momentum equation into the total energy balance:

\[
\rho \frac{De}{Dt}
=
\nabla \cdot (k \nabla T)
+
\boldsymbol{\sigma} : \nabla \mathbf{v}
+
S
\]

\bigskip

Assume:
\begin{itemize}
\item negligible viscous dissipation
\item constant $\rho$, $k$, $c_p$
\item $e = c_p T$
\end{itemize}

\bigskip

When we use $e = c_p T$ and apply the definition of the material time derivative,

\[
\frac{D}{Dt}
=
\frac{\partial}{\partial t}
+
\mathbf{v}\cdot\nabla,
\]

the one-dimensional advection--diffusion equation can be written as

\[
\boxed{
\frac{\partial T}{\partial t}
+
v \frac{\partial T}{\partial x}
=
\alpha \frac{\partial^2 T}{\partial x^2}
+
\frac{S}{\rho c_p}
}
\]

where \(\alpha = \dfrac{k}{\rho c_p}\).

\end{frame}

% ----------------------------------------------------------------------
\begin{frame}{1D Finite Volume Discretization (Control Volume View)}
\centering

% If your .tikz uses \FigWidth internally, you can override it here:
\renewcommand{\FigWidth}{0.92\textwidth}

% Your figure lives here:
\input{../figures/lectures/chap05_fig08_1D_fv_discretization.tikz}

\end{frame}

% ----------------------------------------------------------------------
% ----------------------------------------------------------------------

% ----------------------------------------------------------------------
\begin{frame}{Finite Volume Formulation (No Source)}

Neglect the source term ($S=0$).

\bigskip

Write the 1D advection--diffusion equation in conservative form:
\[
\frac{\partial T}{\partial t}
+
\frac{\partial F}{\partial x}
=
0,
\qquad
F \equiv vT - \alpha \frac{\partial T}{\partial x}.
\]

\bigskip

Integrate over the control volume
$[x_{i-\tfrac12},\,x_{i+\tfrac12}]$:

\[
\int_{x_{i-\tfrac12}}^{x_{i+\tfrac12}}
\frac{\partial T}{\partial t}\,dx
+
\int_{x_{i-\tfrac12}}^{x_{i+\tfrac12}}
\frac{\partial F}{\partial x}\,dx
=
0.
\]

\end{frame}











\begin{frame}{Applying the Fundamental Theorem of Calculus}

Time derivative term:
\[
\int_{x_{i-\tfrac12}}^{x_{i+\tfrac12}}
\frac{\partial T}{\partial t}\,dx
=
\frac{d}{dt}
\int_{x_{i-\tfrac12}}^{x_{i+\tfrac12}} T\,dx.
\]

\bigskip

Flux term (FTC):
\[
\int_{x_{i-\tfrac12}}^{x_{i+\tfrac12}}
\frac{\partial F}{\partial x}\,dx
=
F(x_{i+\tfrac12}) - F(x_{i-\tfrac12}).
\]

\bigskip

Therefore,
\[
\boxed{
\frac{d}{dt}
\int_{x_{i-\tfrac12}}^{x_{i+\tfrac12}} T\,dx
=
F_{i-\tfrac12} - F_{i+\tfrac12}
}
\]

\bigskip

\centering
Storage = $\text{Influx} - \text{Outflux}

\end{frame}
% ----------------------------------------------------------------------
% ----------------------------------------------------------------------
\begin{frame}{Cell Average Definition}

From the integral balance:

\[
\frac{d}{dt}
\int_{x_{i-\tfrac12}}^{x_{i+\tfrac12}} T\,dx
=
F_{i-\tfrac12} - F_{i+\tfrac12}.
\]

\bigskip

Define the cell average temperature:

\[
T_i(t)
\;\equiv\;
\frac{1}{\Delta x}
\int_{x_{i-\tfrac12}}^{x_{i+\tfrac12}} T(x,t)\,dx.
\]

\bigskip

Therefore,

\[
\int_{x_{i-\tfrac12}}^{x_{i+\tfrac12}} T\,dx
=
T_i\,\Delta x.
\]

\bigskip

\centering
Unknown stored at the cell center represents a \textbf{cell average}.

\end{frame}
% ----------------------------------------------------------------------
% ----------------------------------------------------------------------
\begin{frame}{Semi-Discrete Finite Volume Equation}

Substitute the cell average into the conservation statement:

\[
\frac{d}{dt}
\left(
T_i \,\Delta x
\right)
=
F_{i-\tfrac12} - F_{i+\tfrac12}.
\]

\bigskip

Since $\Delta x$ is constant,

\[
\boxed{
\Delta x \,\frac{dT_i}{dt}
=
F_{i-\tfrac12}
-
F_{i+\tfrac12}
}
\]

\bigskip

Or equivalently,

\[
\frac{dT_i}{dt}
=
-\frac{1}{\Delta x}
\left(
F_{i+\tfrac12} - F_{i-\tfrac12}
\right).
\]

\bigskip

\centering
Storage = Influx − Outflux

\end{frame}

% ----------------------------------------------------------------------
% ----------------------------------------------------------------------
\begin{frame}{Face Flux: Diffusion Term}

Recall the total flux:
\[
F = vT - \alpha \frac{\partial T}{\partial x}.
\]

\bigskip

Diffusive contribution:
\[
F^{(d)} = -\alpha \frac{\partial T}{\partial x}.
\]

\bigskip

At the face $x_{i+\tfrac12}$, approximate the gradient using
a central difference:

\[
\left.
\frac{\partial T}{\partial x}
\right|_{i+\tfrac12}
\approx
\frac{T_{i+1}-T_i}{\Delta x}.
\]

\bigskip

Therefore,

\[
\boxed{
F^{(d)}_{i+\tfrac12}
=
-\alpha
\frac{T_{i+1}-T_i}{\Delta x}
}
\]

\end{frame}


% ----------------------------------------------------------------------
% ----------------------------------------------------------------------
% ----------------------------------------------------------------------
\begin{frame}{Face Flux: Convection Term (Central Approximation)}

Convective contribution:
\[
F^{(c)} = vT.
\]

\bigskip

At the face $x_{i+\tfrac12}$:
\[
F^{(c)}_{i+\tfrac12}
=
v\,T_{i+\tfrac12}.
\]

\bigskip

Using a central interpolation,

\[
T_{i+\tfrac12}
=
\frac{T_i + T_{i+1}}{2}.
\]

\bigskip

Therefore,

\[
\boxed{
F^{(c)}_{i+\tfrac12}
=
v \,\frac{T_i + T_{i+1}}{2}
}
\]

\end{frame}


% ----------------------------------------------------------------------
% ----------------------------------------------------------------------
\begin{frame}{Face Flux at $x_{i-\tfrac12}$ (Central Approximations)}

Total flux:
\[
F = vT - \alpha \frac{\partial T}{\partial x}.
\]

\bigskip

At the left face $x_{i-\tfrac12}$:

\[
T_{i-\tfrac12} \approx \frac{T_{i-1}+T_i}{2}
\qquad\Rightarrow\qquad
F^{(c)}_{i-\tfrac12}
=
v\,\frac{T_{i-1}+T_i}{2}.
\]

\[
\left.\frac{\partial T}{\partial x}\right|_{i-\tfrac12}
\approx
\frac{T_i-T_{i-1}}{\Delta x}
\qquad\Rightarrow\qquad
F^{(d)}_{i-\tfrac12}
=
-\alpha\,\frac{T_i-T_{i-1}}{\Delta x}.
\]

\bigskip

Therefore,
\[
\boxed{
F_{i-\tfrac12}
=
v\,\frac{T_{i-1}+T_i}{2}
-\alpha\,\frac{T_i-T_{i-1}}{\Delta x}
}
\]
\end{frame}
% ----------------------------------------------------------------------
% ----------------------------------------------------------------------
\begin{frame}{Semi-Discrete Update (Central Fluxes at Both Faces)}

Finite volume update:
\[
\frac{dT_i}{dt}
=
-\frac{1}{\Delta x}\left(F_{i+\tfrac12}-F_{i-\tfrac12}\right),
\qquad
F = vT - \alpha \frac{\partial T}{\partial x}.
\]

\bigskip

Using central face fluxes:

\[
F_{i+\tfrac12}
=
v\,\frac{T_i+T_{i+1}}{2}
-\alpha\,\frac{T_{i+1}-T_i}{\Delta x},
\qquad
F_{i-\tfrac12}
=
v\,\frac{T_{i-1}+T_i}{2}
-\alpha\,\frac{T_i-T_{i-1}}{\Delta x}.
\]

\bigskip

Substitute and simplify:

\[
\boxed{
\frac{dT_i}{dt}
=
-\;v\,\frac{T_{i+1}-T_{i-1}}{2\Delta x}
\;+\;
\alpha\,\frac{T_{i+1}-2T_i+T_{i-1}}{\Delta x^2}
}
\]

\bigskip

\centering
Central advection stencil + central diffusion stencil
\end{frame}

% ----------------------------------------------------------------------
\begin{frame}{Time Discretization (Forward Euler)}

Semi-discrete equation:
\[
\frac{dT_i}{dt}
=
-\;v\,\frac{T_{i+1}-T_{i-1}}{2\Delta x}
+\alpha\,\frac{T_{i+1}-2T_i+T_{i-1}}{\Delta x^2}.
\]

\bigskip

Approximate the time derivative at $t^n$ (Forward Euler):
\[
\frac{dT_i}{dt}\Big|_{t^n}\approx \frac{T_i^{n+1}-T_i^{n}}{\Delta t}.
\]

\bigskip

Therefore,
\[
\boxed{
T_i^{n+1}
=
T_i^{n}
-\frac{v\Delta t}{2\Delta x}\left(T_{i+1}^{n}-T_{i-1}^{n}\right)
+\frac{\alpha\Delta t}{\Delta x^2}\left(T_{i+1}^{n}-2T_i^{n}+T_{i-1}^{n}\right)
}
\]

\end{frame}

% ----------------------------------------------------------------------
% ----------------------------------------------------------------------
\begin{frame}{Cell Peclet Number and Scheme Behavior}

Recall the fully discrete update:

\[
T_i^{n+1}
=
T_i^{n}
-\frac{v\,\Delta t}{2\Delta x}\left(T_{i+1}^{n}-T_{i-1}^{n}\right)
+\frac{\alpha\,\Delta t}{\Delta x^2}\left(T_{i+1}^{n}-2T_i^{n}+T_{i-1}^{n}\right).
\]

\bigskip

Define the cell Peclet number:

\[
\boxed{
\mathrm{Pe}_{\Delta x}
=
\frac{v\,\Delta x}{\alpha}
}
\]

\bigskip

Interpretation:

\begin{itemize}
\item $\mathrm{Pe}_{\Delta x} \ll 1$ → diffusion-dominated
\item $\mathrm{Pe}_{\Delta x} \gg 1$ → advection-dominated
\item Central schemes may oscillate for large Peclet numbers
\end{itemize}

\bigskip

\centering
Motivation for upwind schemes
\end{frame}
% ----------------------------------------------------------------------

% ----------------------------------------------------------------------
\begin{frame}{Algorithm: 1D Advection--Diffusion (Central Scheme)}

Given:
\[
N,\;\Delta x,\;\Delta t,\;v,\;\alpha,
\qquad
T_i^0 \text{ for } i=0,\dots,N
\]

\bigskip

Define dimensionless parameters:
\[
\lambda_d = \frac{\alpha \Delta t}{\Delta x^2},
\qquad
\lambda_c = \frac{v \Delta t}{2\Delta x}.
\]

\bigskip

\textbf{For each time step $n \to n+1$:}

\begin{enumerate}
\item Apply boundary conditions to $T_0^n$ and $T_N^n$
\item For $i = 1,\dots,N-1$:
\[
T_i^{n+1}
=
T_i^{n}
-
\lambda_c\left(T_{i+1}^n - T_{i-1}^n\right)
+
\lambda_d\left(T_{i+1}^n - 2T_i^n + T_{i-1}^n\right)
\]
\item Advance to next time step
\end{enumerate}

\end{frame}
% ----------------------------------------------------------------------
\begin{frame}{Algorithm (IC, Sweep, BC Update)}

\textbf{Initialization:}
\begin{itemize}
\item Set initial condition: $T_i^0 = T(x_i,0)$ for $i=0,\dots,N$
\item Enforce boundary conditions on $T^0$ (set $T_0^0$, $T_N^0$)
\end{itemize}

\bigskip

\textbf{Time stepping: for $n=0,1,2,\dots$}
\begin{enumerate}
\item (BC at current time) Ensure $T_0^n$ and $T_N^n$ satisfy BCs
\item (Interior sweep) For $i=1,\dots,N-1$ compute
\[
T_i^{n+1}
=
T_i^{n}
-\lambda_c\left(T_{i+1}^n - T_{i-1}^n\right)
+\lambda_d\left(T_{i+1}^n - 2T_i^n + T_{i-1}^n\right)
\]
\item (BC at new time) Set $T_0^{n+1}$ and $T_N^{n+1}$ from BCs
\end{enumerate}

\end{frame}

\end{document}